# **Project: Merch MVP Smart Contract Specification**

This specification details the design and core functions of the smart contracts for deployment on the **Base Sepolia Testnet**.

## **1\. Basic Merch Contract (BasicMerch.sol)**

| Standard | ERC-4973 (Soulbound Token \- SBT) |
| :---- | :---- |
| **Purpose** | **PERMANENT, VISIBLE PROOF OF ATTENDANCE (POA).** Non-transferable, low-cost token. |
| **Key Functions** | **mintSBT(address \_to, uint256 \_eventId, string memory \_tokenURI, bytes memory \_signature):** **CRITICAL CHANGE:** This function is now **public** (allowing anyone to pay gas) but requires a unique signature from the Backend Issuer wallet to validate the mint is authorized. |
|  | getSBTByEvent(address \_owner, uint256 \_eventId): Lookup the SBT ID for a given user/event. |
| **Access Control** | The function uses ecrecover to ensure the submitted \_signature was generated by the trusted Backend Issuer wallet for that specific event and user. **This makes the function public/callable by anyone while maintaining security.** |

## **2\. Premium Merch Contract (PremiumMerch.sol)**

| Standard | ERC-721 (Transferable NFT) |
| :---- | :---- |
| **Purpose** | Tradable, high-value digital collectible (the 'premium' companion asset and revenue source). |
| **Key Functions** | **mintCompanion(uint256 \_sbtId, string memory \_tokenURI): CRITICAL MONETIZATION FUNCTION.** |
| **Logic** | 1\. Accepts a payment (msg.value in test ETH). 2\. **VERIFIES OWNERSHIP** of \_sbtId on the BasicMerch contract (caller must own the SBT). 3\. Mints a new ERC-721 to the user. 4\. Transfers the payment (minus Organizer share) to the Merch Treasury. |
| **Access Control** | The mintCompanion function must ensure the caller owns the prerequisite \_sbtId before proceeding. The Treasury/Organizer addresses must be configurable. |

## **3\. EAS Attestation Logic**

| Standard | Ethereum Attestation Service (EAS) |
| :---- | :---- |
| **Schema** | Custom schema registered on Base Sepolia: **MerchAttendance** |
| **Data Fields** | eventId (bytes32), timestamp (uint256), isPremium (bool), **sbtTokenId (uint256)** (New Field to link records) |
| **Attester** | The dedicated **Backend Attester Wallet** (pre-funded). |
| **Trigger** | Executed by the **Backend API** upon successful on-chain transaction confirmation (Mint of SBT *or* Mint of ERC-721). |
| **Role** | Provides the verifiable, immutable record of the attendance claim, decoupling historical proof from the tradable asset's status. |

